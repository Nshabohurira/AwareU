<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Learning Modules - AwareU</title>

<style>
:root {
  --primary: #1aa6a6;
  --secondary: #4E54C8;
  --muted: #f5f5f5;
  --text: #1f2937;
  --text-muted: #64748b;
}

/* Base */
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
  background:#f9fafb;
  color:var(--text);
}
a { text-decoration:none; color:inherit; }

/* ================= Sidebar ================= */
.sidebar {
  width: 230px;
  background: #ffffff;
  padding: 20px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid #eee;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  z-index: 1300;
}

.logo {
  color: var(--primary);
  font-size: 24px;
  font-weight: bold;
  margin-bottom: 30px;
  text-align: center;
}

.sidebar nav a {
  display: block;
  padding: 10px;
  color: #555;
  border-radius: 6px;
  margin-bottom: 6px;
  transition: 0.3s;
}

.sidebar nav a.active,
.sidebar nav a:hover {
  background: #e7f6f6;
  color: var(--primary);
}

.logout {
  margin-top: auto;
  padding: 10px;
  border: none;
  background:red;
  border-radius: 6px;
  cursor: pointer;
}

/* ================= Mobile Header ================= */
.mobile-header {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  height: 56px;
  width: 100%;
  background: #ffffff;
  border-bottom: 1px solid #e5e7eb;
  padding: 0 16px;
  align-items: center;
  gap: 12px;
  z-index: 1200;
}

.mobile-header button {
  font-size: 22px;
  background: none;
  border: none;
  cursor: pointer;
}

/* Overlay */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 1100;
}

.overlay.show {
  opacity: 1;
  pointer-events: all;
}


.main-content {
  margin-left: 260px; /* keeps space for sidebar */
  padding: 30px;
  min-height: 100vh;
  transition: margin-left 0.3s ease;
}

@media (max-width: 900px) {
  .main-content {
    margin-left: 0; /* sidebar becomes horizontal or collapses */
    padding: 20px;
  }
}

.module.locked {
  opacity: 0.5;
  pointer-events: none;
}

.module.current {
  border: 2px solid var(--primary);
  background: #f0fdfd;
}
.module {
  transition: opacity 0.3s ease;
}

  /* Card Styling */
  .card {
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 16px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.06);
    padding: 24px;
    margin-bottom: 20px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .card:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); }

  .progress-container { margin-bottom: 30px; }
  .progress-bar { width: 100%; height: 14px; background: var(--muted); border-radius: 8px; overflow: hidden; margin-top: 10px; }
  .progress-fill { height: 100%; width: 0%; background: var(--primary); border-radius: 8px; transition: width 0.3s ease; }

  .flex { display: flex; align-items: center; gap: 10px; }
  .btn { padding: 10px 16px; border-radius: 8px; cursor: pointer; border: none; transition: 0.2s; font-size: 14px; font-weight: 500; }
  .btn-primary { background: var(--primary); color:#fff; }
  .btn-primary:hover { opacity: 0.9; }
  .btn-secondary { background: var(--secondary); color:#fff; }
  .btn-secondary:hover { opacity: 0.9; }
  .btn-outline { background: #fff; border:1px solid var(--primary); color: var(--primary);}
  .btn-outline:hover { background: var(--primary); color:#fff; }

  /* Module Status Circle */
  .module-status {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    display:flex;
    justify-content:center;
    align-items:center;
    background: var(--muted);
    font-weight:bold;
    font-size:16px;
    flex-shrink: 0;
  }
  .module-status.completed { background: var(--secondary); color: #fff; }

  .module-content h3 { font-size: 20px; margin: 0 0 8px 0; }
  .module-content p { font-size: 15px; color: var(--text-muted); margin-bottom: 10px; line-height:1.5; }
  .module-meta { font-size: 14px; color: var(--text-muted); gap: 12px; display:flex; margin-bottom: 12px; }

  /* Loading placeholder */
  .loading { background: var(--muted); height: 16px; margin-bottom: 8px; border-radius: 6px; animation: pulse 1.2s infinite; }
  @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }


/* ================= Mobile Behaviour ================= */
@media (max-width: 900px) {

  .mobile-header { display: flex; }

  .sidebar {
    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }

  .sidebar.open {
    transform: translateX(0);
  }

  .main-content {
    margin-left: 0;
    padding-top: 76px;
  }
}
</style>
</head>

<body>

<!-- Mobile Header -->
<div class="mobile-header">
  <button id="sidebarToggle">☰</button>
  <strong>AwareU</strong>
</div>

<div class="overlay" id="overlay"></div>

<!-- Sidebar -->
<aside class="sidebar">
  <h2 class="logo">AwareU</h2>
  <nav>
    <a href="dashboard.html">Dashboard</a>
    <a href="modules.html" class="active">Learning Modules</a>
    <a href="resources.html">Resources</a>
    <a href="quizzes.html">Quizzes</a>
    <a href="chatbot.html">Chat</a>
    <a href="events.html">Events</a>
    <a href="contact.html">Get Help</a>
    <a href="progress.html">My Progress</a>
    <a href="profile.html">Profile</a>
    
  </nav>
  <button class="logout">Logout</button>
</aside>

<!-- Main Content -->
<div class="main-content">
  <h1>Learning Modules</h1>
  <p>Complete modules to expand your knowledge</p>

  <!-- Progress Overview -->
  <div class="card progress-container">
    <div class="flex" style="justify-content: space-between;">
      <span class="font-semibold">Your Progress</span>
      <span id="progress-count">0/0</span>
    </div>
    <div class="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
    <p id="progress-percent">0% Complete</p>

    <button class="btn btn-outline" id="resetModulesBtn" style="margin-top:12px;">
  Restart Modules
    </button>

  </div>

  <!-- Modules List -->
  <div id="modules-list"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("resetModulesBtn").addEventListener("click", () => {
  const confirmReset = confirm(
    "This will reset all module progress. Are you sure?"
  );

  if (!confirmReset) return;

  localStorage.removeItem("moduleProgress");
  progress = {};
  renderModules();
});


const modulesData = [
  {
    id: "mod1",
    title: "Introduction to Drug Awareness",
    description: `Understanding the basics of substance abuse and its impact on university students.

This module covers the fundamental concepts of drug awareness, including why it matters for students, common misconceptions, and the real statistics behind substance use on campus. You will...`,
    estimated_minutes: 10,
    videoLink: "https://www.youtube.com/watch?v=lWItmmunbvQ"
  },
  // next modules...

  {
    id: "mod2",
    title: "The Science Behind Addiction",
    description: `Learn how substances affect your brain chemistry and why addiction develops.

Dive deep into the neuroscience of addiction. This module explains how drugs hijack the brain's reward system, the role of dopamine, and why some people are more vulnerable to addiction`,
    estimated_minutes: 10,
    videoLink: "https://www.youtube.com/watch?v=i4gvIeA3RcI"
  },
  {
    id: "mod3",
    title: "Healthy Coping Strategies",
    description: `Discover effective alternatives to substance use for managing stress and emotions.

Explore evidence-based techniques for managing university stress, anxiety, and social pressures without turning to substances. Topics include mindfulness, exercise, social support, time management,`,
    estimated_minutes: 10,
    videoLink: "https://www.youtube.com/watch?v=xG0B7uOEPB4"
  }
];


  const modulesList = document.getElementById("modules-list");
  const progressCountEl = document.getElementById("progress-count");
  const progressFillEl = document.getElementById("progress-fill");
  const progressPercentEl = document.getElementById("progress-percent");

  let progress = JSON.parse(localStorage.getItem("moduleProgress")) || {};

  function getYouTubeID(url) {
    const match = url.match(/(?:v=|youtu\.be\/)([\w-]+)/);
    return match ? match[1] : null;
  }

  function renderModules() {
    modulesList.innerHTML = "";
    let firstIncompleteFound = false;

    modulesData.forEach((module, index) => {
      const isCompleted = progress[module.id];
      let state = "locked";

      if (isCompleted) state = "completed";
      else if (!firstIncompleteFound) {
        state = "current";
        firstIncompleteFound = true;
      }

      const card = document.createElement("div");
      card.className = `card module ${state}`;

      card.innerHTML = `
        <div class="flex">
          <div class="module-status ${state === "completed" ? "completed" : ""}">
            ${state === "completed" ? "✓" : index + 1}
          </div>

          <div class="module-content" style="flex:1; margin-left:12px;">
            <h3>${module.title}</h3>
            <p>${module.description}</p>

            <div class="module-meta">
              <span>⏱️ ${module.estimated_minutes} min</span>
            </div>

            <div class="flex" style="gap:8px;">
              ${
                state === "current"
                  ? `<button class="btn btn-primary" onclick="watchVideo('${module.id}')">Watch Video</button>`
                  : state === "completed"
                  ? `<button class="btn btn-secondary" disabled>Completed</button>`
                  : `<button class="btn btn-outline" disabled>Locked</button>`
              }
            </div>

            <div id="video-${module.id}" style="margin-top:12px;"></div>
          </div>
        </div>
      `;

      modulesList.appendChild(card);
    });

    updateProgress();
  }

 window.watchVideo = function(moduleId) {
  const container = document.getElementById(`video-${moduleId}`);

  // prevent duplicate embed
  if (container.innerHTML.trim() !== "") return;

  const module = modulesData.find(m => m.id === moduleId);
  const videoId = getYouTubeID(module.videoLink);

  container.innerHTML = `
    <iframe width="100%" height="315"
      src="https://www.youtube.com/embed/${videoId}"
      frameborder="0" allowfullscreen></iframe>

    <button class="btn btn-secondary" style="margin-top:12px"
      onclick="completeModule('${moduleId}')">
      Mark as Completed
    </button>
  `;
};

  window.completeModule = function(moduleId) {
  if (!progress[moduleId]) {
    progress[moduleId] = true;
    localStorage.setItem("moduleProgress", JSON.stringify(progress));
  }
  renderModules();
};

  function updateProgress() {
  const total = modulesData.length;

  // count only modules that actually exist
  const completed = modulesData.filter(
    module => progress[module.id] === true
  ).length;

  const percent = Math.round((completed / total) * 100);

  progressCountEl.textContent = `${completed}/${total}`;
  progressFillEl.style.width = percent + "%";
  progressPercentEl.textContent = `${percent}% Complete`;
}


  renderModules();
});

</script>

</body>
</html>
